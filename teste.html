<!DOCTYPE html>
<html>
<head>
    <title>webcam</title>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="css/qrcode.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script type="text/javascript" src="js/qrcodelib.js"></script>
    <script type="text/javascript" src="js/webcodecamjs.js"></script>
</head>
<body>
    <div class="well" style="position: relative;display: inline-block;">
        <canvas width="320" height="240" id="webcodecam-canvas"></canvas>
        <div class="scanner-laser laser-rightBottom" style="opacity: 0.5;"></div>
        <div class="scanner-laser laser-rightTop" style="opacity: 0.5;"></div>
        <div class="scanner-laser laser-leftBottom" style="opacity: 0.5;"></div>
        <div class="scanner-laser laser-leftTop" style="opacity: 0.5;"></div>
        <div class="scanner-laser webcamChange" id="webcamChange"></div>
    </div>
    <select style="display: none;"></select>

    <div id="resultado"></div>

    <script type="text/javascript">
        var decoder = new WebCodeCamJS("#webcodecam-canvas").buildSelectMenu('select', 'environment|back').init().play();
        
        document.querySelector('select').addEventListener('change', function(){
            decoder.stop().play();
        });

        document.getElementById('webcamChange').addEventListener('click', function() {
            var opts = document.querySelector('select').options.length;
            var opt = document.querySelector('select').selectedIndex + 1;

            if(opt+1 > opts) {
                opt = 1;
            } else {
                opt += 1;
            }
            document.querySelector('select').selectedIndex = opt - 1;

            var event = document.createEvent('MouseEvents');
            event.initMouseEvent('change', true, true,
                document.querySelector('select').ownerDocument.defaultView,
                0, 0, 0, 0, 0, false, false, false, false, 0, null);

            document.querySelector('select').dispatchEvent( event );
        });
    </script>
</body>
</html>